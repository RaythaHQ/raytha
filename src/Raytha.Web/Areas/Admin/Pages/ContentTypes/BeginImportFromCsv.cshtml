@page "/raytha/{contentTypeDeveloperName}/begin-import-from-csv"
@model Raytha.Web.Areas.Admin.Pages.ContentTypes.BeginImportFromCsv

@{
    var pageTitle = $"{Model.CurrentView.ContentType.LabelPlural} > Create";
    Layout = "SidebarLayout";
    ViewData["Title"] = pageTitle;
    ViewData["ActiveMenu"] = Model.CurrentView.ContentType.DeveloperName;
}

<partial name="_Partials/PageHeading" model='ViewData["Title"]' />

<div class="row mb-4">
    <div class="col-xxl-7 col-xl-8 col-lg-9 col-md-12">
        <div class="card border-0 shadow mb-4">
            <div class="card-body">

                <form asp-page="@RouteNames.ContentItems.Create" method="post" class="py-4">
                    <div class="col-lg-12 mt-2">
                        <div class="mb-3">
                            <label class="form-label raytha-required" asp-for="@Model.Form.TemplateId"></label>
                            <select class="form-select @Model.HasError("TemplateId")" asp-for="@Model.Form.TemplateId">
                                <option value="">-- SELECT --</option>
                                @foreach (var template in Model.Form.AvailableTemplates)
                                {
                                    <option value="@template.Key">@template.Value</option>
                                }
                            </select>
                            <div class="invalid-feedback">@Model.ErrorMessageFor("TemplateId")</div>
                        </div>
                    </div>           
                    <hr/>
                    <div>
                        @for (int i = 0; i < Model.Form.FieldValues.Count(); i++)
                        {
                            @if (Model.Form.FieldValues[i].FieldType == "single_line_text")
                            {
                                <div class="col-lg-12 col-md-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName">
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        <input type="text" class="form-control @Model.HasError(Model.Form.FieldValues[i].DeveloperName)" asp-for="@Model.Form.FieldValues[i].Value">
                                        <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                    </div>
                                </div>                          
                            }
                            else if (Model.Form.FieldValues[i].FieldType == "dropdown")
                            {
                                <div class="col-lg-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName">
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        <select class="form-select @Model.HasError(Model.Form.FieldValues[i].DeveloperName)" asp-for="@Model.Form.FieldValues[i].Value">
                                            <option value="">-- SELECT --</option>
                                            @foreach (var availableChoice in Model.Form.FieldValues[i].AvailableChoices)
                                            {
                                                @if (availableChoice.Disabled)
                                                {
                                                    <option value="@availableChoice.Value" disabled="">@availableChoice.Label (disabled)</option>
                                                }
                                                else
                                                {
                                                    <option value="@availableChoice.Value">@availableChoice.Label</option>
                                                }
                                            }
                                        </select>
                                        <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                    </div>
                                </div>
                            }
                            else if (Model.Form.FieldValues[i].FieldType == "radio")
                            {
                                <div class="col-lg-12 mt-4"  id="raytha_field-@Model.Form.FieldValues[i].DeveloperName">
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        @{
                                            var lastItem = Model.Form.FieldValues[i].AvailableChoices.LastOrDefault();
                                        }
                                        @foreach (var availableChoice in Model.Form.FieldValues[i].AvailableChoices)
                                        {
                                            <div class="form-check">
                                                @if (availableChoice.Disabled) 
                                                {
                                                    <input class="form-check-input @Model.HasError(Model.Form.FieldValues[i].DeveloperName)" type="radio" asp-for="@Model.Form.FieldValues[i].Value" value="@availableChoice.DeveloperName"  disabled="">
                                                }
                                                else
                                                {
                                                    <input class="form-check-input @Model.HasError(Model.Form.FieldValues[i].DeveloperName)" type="radio" asp-for="@Model.Form.FieldValues[i].Value" value="@availableChoice.DeveloperName">
                                                }
                                                <label class="form-check-label" asp-for="@Model.Form.FieldValues[i].Value">@availableChoice.Label</label>
                                                @if (availableChoice == lastItem)
                                                {
                                                    <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                                }
                                            </div>
                                        }

                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                    </div>
                                </div>                            
                            }
                            else if (Model.Form.FieldValues[i].FieldType == "number")
                            {
                                <div class="col-lg-3 col-md-4 col-sm-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName">
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        <input type="text" pattern="[0-9]+([\.,][0-9]+)?" class="form-control @Model.HasError(Model.Form.FieldValues[i].DeveloperName)" asp-for="@Model.Form.FieldValues[i].Value">

                                        <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                    </div>
                                </div>   
                            }
                            else if (Model.Form.FieldValues[i].FieldType == "checkbox")
                            {
                                <div class="col-lg-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName">
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input @Model.HasError(Model.Form.FieldValues[i].DeveloperName)" type="checkbox" asp-for="@Model.Form.FieldValues[i].Value"> 
                                            <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        </div>

                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                    </div>
                                </div> 
                            }
                            else if (Model.Form.FieldValues[i].FieldType == "multiple_select")
                            {
                                <div class="col-lg-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName">
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        @for (var j = 0; j < Model.Form.FieldValues[i].AvailableChoices.Count(); j++)
                                        {
                                            <div class="form-check">
                                                @if (Model.Form.FieldValues[i].AvailableChoices[j].Disabled)
                                                {
                                                    <input class="form-check-input @Model.HasError(Model.Form.FieldValues[i].DeveloperName)" type="checkbox" asp-for="@Model.Form.FieldValues[i].AvailableChoices[j].Value" disabled="">
                                                }
                                                else
                                                {
                                                    <input class="form-check-input @Model.HasError(Model.Form.FieldValues[i].DeveloperName)" type="checkbox" asp-for="@Model.Form.FieldValues[i].AvailableChoices[j].Value">
                                                }

                                                <label class="form-check-label" asp-for="@Model.Form.FieldValues[i].AvailableChoices[j].DeveloperName">@Model.Form.FieldValues[i].AvailableChoices[j].Label</label>
                                            
                                                @if (j == Model.Form.FieldValues[i].AvailableChoices.Count() - 1)
                                                {
                                                    <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                                }
                                            </div>
                                            <input type="hidden" asp-for="@Model.Form.FieldValues[i].AvailableChoices[j].DeveloperName" />
                                        }
                                        <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                    </div>
                                </div>                                
                            }
                            else if (Model.Form.FieldValues[i].FieldType == "date")
                            {
                                <div class="col-lg-3 col-md-4 col-sm-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName">
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        <div class="input-group">
                                            <span class="input-group-text">
                                                <svg class="icon icon-xs text-gray-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path></svg> 
                                            </span>
                                            <input data-datepicker="" class="form-control datepicker-input @Model.HasError(Model.Form.FieldValues[i].DeveloperName)" asp-for="@Model.Form.FieldValues[i].Value" type="text">
                                            <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        </div>

                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                    </div>
                                </div>                             
                            }
                            else if (Model.Form.FieldValues[i].FieldType =="long_text")
                            {
                                <div class="col-lg-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName">
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        <textarea class="@Model.HasError(Model.Form.FieldValues[i].DeveloperName) form-control" id="input-@Model.Form.FieldValues[i].DeveloperName" value="@Model.Form.FieldValues[i].Value" asp-for="@Model.Form.FieldValues[i].Value"></textarea>
                                        <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                    </div>
                                </div>                            
                            }
                            else if (Model.Form.FieldValues[i].FieldType == "wysiwyg")
                            {
                                <div class="col-lg-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName"
                                    
                                    
                                    
                                     
                                     
                                    
                                    
                                    >
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        <div></div>
                                        <textarea
                                                data-developername="@Model.Form.FieldValues[i].DeveloperName" 
                                                id="input-@Model.Form.FieldValues[i].DeveloperName"
                                                  asp-for="@Model.Form.FieldValues[i].Value" hidden></textarea>
                                        <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                    </div>
                                </div>
                            }
                            else if (Model.Form.FieldValues[i].FieldType == "attachment")
                            {
                                <div class="col-lg-12 col-md-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName"
                               
                               
                               
                               
                               ,
                               >                          
                                    <div class="mb-3">
                                        <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                        <div id="@(Model.Form.FieldValues[i].DeveloperName)-uppy"></div>
                                        <div id="@(Model.Form.FieldValues[i].DeveloperName)-uppy-progress"></div>
                                        <div hidden>
                                            <p>@Model.Form.FieldValues[i].Value</p>
                                            <a class="btn btn-primary" asp-route="mediaitemsredirecttofileurlbyobjectkey" asp-route-objectKey="@Model.Form.FieldValues[i].Value" target="_blank">View file</a>
                                            <button hidden class="btn btn-sm text-danger" type="button"><svg class="icon icon-xs" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> Remove</button>
                                        </div>
                                        @if (!string.IsNullOrEmpty(Model.HasError(Model.Form.FieldValues[i].DeveloperName)))
                                        {
                                            <div class="text-danger">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        }
                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                        <input type="hidden" class="@Model.HasError(Model.Form.FieldValues[i].DeveloperName)" asp-for="@Model.Form.FieldValues[i].Value" />
                                    </div>
                                </div>                              
                            }
                            else if (Model.Form.FieldValues[i].FieldType == "one_to_one_relationship")
                            {
                                <div class="col-lg-12 col-md-12 mt-4" id="raytha_field-@Model.Form.FieldValues[i].DeveloperName">
                                    <div class="mb-3">
                                        <div>
                                            <label class="form-label @Model.Form.FieldValues[i].AsteriskCssIfRequired" asp-for="@Model.Form.FieldValues[i].Label">@Model.Form.FieldValues[i].Label</label>
                                            <div class="spinner-border spinner-border-sm mt-1 ml-2" role="status">
                                                <span class="visually-hidden">Loading pages...</span>
                                            </div>
                                        </div>

                                        <button class="btn btn-primary btn-sm" type="button" 
                                           
                                           >
                                            <svg class="icon icon-xs me-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg> Add relationship
                                        </button>

                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control" value="@Model.Form.FieldValues[i].RelatedContentItemPrimaryField" disabled>
                                            <button class="nav-link d-inline-flex align-items-center justify-content-center text-danger" type="button"><svg class="icon icon-sm mx-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> Remove</button>
                                        </div>

                                        <input type="text" class="form-control @Model.HasError(Model.Form.FieldValues[i].DeveloperName)">
                                        <ul class="list-group"></ul>
                                        <div class="invalid-feedback">@Model.ErrorMessageFor(Model.Form.FieldValues[i].DeveloperName)</div>
                                        @if (!string.IsNullOrEmpty(Model.Form.FieldValues[i].Description))
                                        {
                                            <div class="form-text">@Model.Form.FieldValues[i].Description</div>
                                        }
                                        <input type="hidden" asp-for="@Model.Form.FieldValues[i].Value" />
                                        <input type="hidden" asp-for="@Model.Form.FieldValues[i].RelatedContentItemPrimaryField" />
                                    </div>
                                </div>                          
                            }
                            <input type="hidden" asp-for="@Model.Form.FieldValues[i].DeveloperName" />
                            <input type="hidden" asp-for="@Model.Form.FieldValues[i].FieldType" />
                        }
                    </div>      
                    <div class="col-lg-12">
                        <button type="submit" class="btn btn-secondary" name="SaveAsDraft" value="true">Save as draft</button>
                        <button type="submit" class="btn btn-success mx-2" name="SaveAsDraft" value="false">Save and publish</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>