<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Embed Functions Inside Raytha with Custom Code </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Embed Functions Inside Raytha with Custom Code ">
      
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      
      
      
      <meta name="docfx:docurl" content="https://github.com/RaythaHQ/raytha/blob/main/docfx_project/articles/embeddable_functions_intro.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="embed-functions-inside-raytha-with-custom-code">Embed Functions Inside Raytha with Custom Code</h1>

<h2 id="introduction-to-raytha-functions">Introduction to Raytha Functions</h2>
<p>Raytha Functions are a way to write custom code in the administrator portal of Raytha to add functionality to your application. Use cases for this include but are not limited to:</p>
<ul>
<li>Create your own custom api endpoints</li>
<li>Accept form submissions and save response</li>
<li>Send an email out of the platform</li>
<li>Make an external HTTP call and return and/or save result</li>
<li>[Coming Soon] Webhooks trigger functionality</li>
<li>[Coming Soon] Timer trigger functionality</li>
</ul>
<p>In a way, it is effectively writing &quot;code behind&quot; directly into the platform.</p>
<img class="inline-img" src="../images/functions_sidebar.png">
<h2 id="writing-code-behind">Writing code behind</h2>
<p>When you write code for a Raytha Function there are few items you need to be aware of.</p>
<ul>
<li><strong>Write your code in javascript.</strong> The code is compiled and run using Microsoft's ClearScript engine which works with V8 implementation of javascript. This gives you access to basic engine javascript.</li>
<li><strong>Triggers.</strong> Functions are triggered by some action. You select the trigger type when you create the function.</li>
<li><strong>Built-in objects.</strong> The javascript by itself would not be of much use if you did not have layer of access to the database and other core functionality.</li>
</ul>
<h2 id="triggers">Triggers</h2>
<p>Raytha Functions are triggered by some action. You select the trigger type when you create the function.</p>
<img class="inline-img" src="../images/functions_triggertype.png">
<p>Triggers come with boilerplate code that the ClearScript engine runs when necessary. Click the link below to learn how to write code for each trigger type.</p>
<ul>
<li><a href="/articles/embeddable_functions_httprequest.html">Http Request</a></li>
<li>[Coming Soon] Timer</li>
<li>[Coming Soon] Webhook</li>
</ul>
<h2 id="built-in-objects">Built-in Objects</h2>
<p>To provide valuable functionality to you while you write Raytha Functions, the following objects are included in the ClearScript engine that you can call.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>API_V1</td>
<td>API to Raytha's Application Layer</td>
</tr>
<tr>
<td>CurrentOrganization</td>
<td>Object with access to the current org settings like name, timezone, etc.</td>
</tr>
<tr>
<td>CurrentUser</td>
<td>Information about the current logged in user</td>
</tr>
<tr>
<td>Emailer</td>
<td>Send an email from the platform</td>
</tr>
<tr>
<td>HttpClient</td>
<td>Make an external API call</td>
</tr>
</tbody>
</table>
<p><a href="/articles/embeddable_functions_builtinobjects.html">Learn how to make use of these objects</a>.</p>
<h2 id="settings-and-environment-variables">Settings and Environment Variables</h2>
<p>By default, Raytha sets the following three settings in appsettings.json:</p>
<table>
<thead>
<tr>
<th>Env Var</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>RAYTHA_FUNCTIONS_MAX_ACTIVE</td>
<td>5</td>
</tr>
<tr>
<td>RAYTHA_FUNCTIONS_TIMEOUT</td>
<td>10000</td>
</tr>
<tr>
<td>RAYTHA_FUNCTIONS_QUEUE_TIMEOUT</td>
<td>10000</td>
</tr>
</tbody>
</table>
<p>You can override these by setting environment variables, or modifying appsettings.json, whichever your preference.</p>
<p>If you set <code>RAYTHA_FUNCTIONS_MAX_ACTIVE</code> to 0, then you will disable Raytha Functions entirely and the menu option will not even appear in the administrator backend. This setting sets the maximum number of concurrent functions that can run at a time. For example, if you have this setting set to 5, and there are currently 5 functions running simultaneously, and a 6th call is started, the 6th will wait in a queue until a spot becomes available.</p>
<p><code>RAYTHA_FUNCTIONS_TIMEOUT</code> and <code>RAYTHA_FUNCTIONS_QUEUE_TIMEOUT</code> are specified in ms, so those default values are 10 seconds.</p>
<p><code>RAYTHA_FUNCTIONS_TIMEOUT</code> specifies the length of time the function has to execute the code. If it takes longer than that, then the function is terminated. <code>RAYTHA_FUNCTIONS_QUEUE_TIMEOUT</code> is the length of time a call will wait for a spot to open up if the max active functions is exceeded.</p>
<p>These settings are to ensure safety with your application, helping prevent bad code, or a malicious actor from taking too many compute resources.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/RaythaHQ/raytha/blob/main/docfx_project/articles/embeddable_functions_intro.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>


    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
